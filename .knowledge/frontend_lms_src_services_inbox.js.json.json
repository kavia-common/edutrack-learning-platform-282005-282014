{"is_source_file": true, "format": "JavaScript", "description": "This file implements a client-side inbox service for onboarding documents, providing functions to list, submit, retrieve, and update documents stored in localStorage. It includes handling for JSON payloads, PDF blobs, and generating printable HTML snapshots for JSON-only entries. The code is modular, with clear public API functions and internal helpers for handling storage, normalization, and HTML escaping.", "external_files": [], "external_methods": ["window.dispatchEvent", "window.localStorage.getItem", "window.localStorage.setItem", "URL.createObjectURL", "JSON.parse", "JSON.stringify", "Date", "CustomEvent", "window.addEventListener", "window.removeEventListener"], "published": ["listInbox", "submitDocument", "getInboxById", "submitJson", "updateStatus", "ensurePrintableHtml", "subscribeInbox"], "classes": [], "methods": [{"name": "safeParse(raw, fallback = [])", "description": "Safely parses JSON string into an array; returns fallback if parsing fails or result is not an array.", "scope": "", "scopeKind": ""}, {"name": "emitUpdate(detail = {})", "description": "Dispatches a custom event to notify other parts of the application about inbox updates.", "scope": "", "scopeKind": ""}, {"name": "normalizeStatus(s)", "description": "Normalizes various status string inputs into standardized status values.", "scope": "", "scopeKind": ""}, {"name": "listInbox()", "description": "Returns all stored inbox documents, sorted newest first.", "scope": "", "scopeKind": ""}, {"name": "submitDocument({ title, blob, type = 'onboarding', status = 'submitted', submittedBy = 'anonymous' })", "description": "Stores a new document with optional blob or data URL, updating localStorage and emitting an update event.", "scope": "", "scopeKind": ""}, {"name": "getInboxById(id)", "description": "Retrieves a specific inbox document by its ID.", "scope": "", "scopeKind": ""}, {"name": "submitJson({ title, payload, type = 'onboarding', status = 'submitted', submittedBy = 'anonymous' })", "description": "Stores a JSON payload as an inbox entry with a generated printable HTML snapshot.", "scope": "", "scopeKind": ""}, {"name": "updateStatus(id, nextStatus)", "description": "Updates the status of a specified inbox item and persists the change.", "scope": "", "scopeKind": ""}, {"name": "ensurePrintableHtml(id)", "description": "Generates and attaches a printable HTML snapshot for an inbox item if not already present.", "scope": "", "scopeKind": ""}, {"name": "buildPrintableHtml({ title, payload, submittedBy, createdAt })", "description": "Constructs an HTML string that represents the inbox item in a printable format.", "scope": "", "scopeKind": ""}, {"name": "escapeHtml(str)", "description": "Escapes HTML special characters for safe embedding of JSON payloads into HTML.", "scope": "", "scopeKind": ""}, {"name": "subscribeInbox(callback)", "description": "Subscribes to inbox changes via storage events and custom events; returns an unsubscribe function.", "scope": "", "scopeKind": ""}], "search-terms": ["localStorage", "inbox", "submitDocument", "JSON payload", "PDF blob", "printableHtml", "updateStatus", "inbox event", "client-side persistence", "public API"], "state": 2, "file_id": 35, "knowledge_revision": 186, "git_revision": "591276e6179d453d6c3b08676514043fdc65ab0d", "revision_history": [{"156": ""}, {"181": "d53a9f6eb8b28e1dc92d94e2067dcc0b22e767a3"}, {"186": "591276e6179d453d6c3b08676514043fdc65ab0d"}], "ctags": [{"_type": "tag", "name": "STORAGE_KEY", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^const STORAGE_KEY = 'ONBOARDING_DOCS';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "approved", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^    approved: 'approved',$/", "language": "JavaScript", "kind": "property", "scope": "normalizeStatus.map", "scopeKind": "class"}, {"_type": "tag", "name": "buildPrintableHtml", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^function buildPrintableHtml({ title, payload, submittedBy, createdAt }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ title, payload, submittedBy, createdAt })"}, {"_type": "tag", "name": "emitUpdate", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^function emitUpdate(detail = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(detail = {})"}, {"_type": "tag", "name": "ensurePrintableHtml", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^export function ensurePrintableHtml(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "escapeHtml", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^function escapeHtml(str) {$/", "language": "JavaScript", "kind": "function", "signature": "(str)"}, {"_type": "tag", "name": "getInboxById", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^export function getInboxById(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^      id,$/", "language": "JavaScript", "kind": "field", "scope": "submitDocument.submitted", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^      id,$/", "language": "JavaScript", "kind": "field", "scope": "submitJson.record", "scopeKind": "class"}, {"_type": "tag", "name": "in review", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^    'in review': 'in_review',$/", "language": "JavaScript", "kind": "property", "scope": "normalizeStatus.map", "scopeKind": "class"}, {"_type": "tag", "name": "in_review", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^    in_review: 'in_review',$/", "language": "JavaScript", "kind": "property", "scope": "normalizeStatus.map", "scopeKind": "class"}, {"_type": "tag", "name": "listInbox", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^export function listInbox() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "map", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^  const map = {$/", "language": "JavaScript", "kind": "class", "scope": "normalizeStatus", "scopeKind": "class"}, {"_type": "tag", "name": "normalizeStatus", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^function normalizeStatus(s) {$/", "language": "JavaScript", "kind": "function", "signature": "(s)"}, {"_type": "tag", "name": "rejected", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^    rejected: 'rejected',$/", "language": "JavaScript", "kind": "property", "scope": "normalizeStatus.map", "scopeKind": "class"}, {"_type": "tag", "name": "safeParse", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^function safeParse(raw, fallback = []) {$/", "language": "JavaScript", "kind": "function", "signature": "(raw, fallback = [])"}, {"_type": "tag", "name": "submitDocument", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^export function submitDocument({ title, blob, type = 'onboarding', status = 'submitted', submitt/", "language": "JavaScript", "kind": "function", "signature": "({ title, blob, type = 'onboarding', status = 'submitted', submittedBy = 'anonymous' })"}, {"_type": "tag", "name": "submitJson", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^export function submitJson({ title, payload, type = 'onboarding', status = 'submitted', submitte/", "language": "JavaScript", "kind": "function", "signature": "({ title, payload, type = 'onboarding', status = 'submitted', submittedBy = 'anonymous' })"}, {"_type": "tag", "name": "submitted", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^    submitted: 'submitted',$/", "language": "JavaScript", "kind": "property", "scope": "normalizeStatus.map", "scopeKind": "class"}, {"_type": "tag", "name": "subscribeInbox", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^export function subscribeInbox(callback) {$/", "language": "JavaScript", "kind": "function", "signature": "(callback)"}, {"_type": "tag", "name": "updateStatus", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/services/inbox.js", "pattern": "/^export function updateStatus(id, nextStatus) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, nextStatus)"}], "hash": "cc79862672267f7092b84dc117fa9d44", "format-version": 4, "code-base-name": "frontend_lms", "filename": "frontend_lms/src/services/inbox.js", "fields": [{"name": "approved: 'approved',", "scope": "normalizeStatus.map", "scopeKind": "class", "description": "unavailable"}, {"name": "id,", "scope": "submitDocument.submitted", "scopeKind": "class", "description": "unavailable"}, {"name": "'in review': 'in_review',", "scope": "normalizeStatus.map", "scopeKind": "class", "description": "unavailable"}, {"name": "in_review: 'in_review',", "scope": "normalizeStatus.map", "scopeKind": "class", "description": "unavailable"}, {"name": "rejected: 'rejected',", "scope": "normalizeStatus.map", "scopeKind": "class", "description": "unavailable"}, {"name": "submitted: 'submitted',", "scope": "normalizeStatus.map", "scopeKind": "class", "description": "unavailable"}]}