{"is_source_file": true, "format": "jsx", "description": "React component for the 'Code of Conduct' page that displays the document, collects user acknowledgment with name and signature upload, supports PDF export, and stores data locally in localStorage.", "external_files": ["../utils/documentsStatus", "../components/ui/Toast", "../utils/inboxUpdate"], "external_methods": ["setDocumentCompleted", "useToast", "upsertInboxPdfForUser"], "published": ["CodeOfConduct"], "classes": [], "methods": [{"name": "loadLocal()", "description": "Loads acknowledgment data from localStorage based on a specific key, returning default values if data is missing or invalid.", "scope": "", "scopeKind": ""}, {"name": "saveLocal(state)", "description": "Saves acknowledgment data into localStorage under a specific key.", "scope": "", "scopeKind": ""}, {"name": "ensurePdfLibs()", "description": "Asynchronously loads html2canvas and jsPDF libraries from CDN, falling back to null if unavailable.", "scope": "", "scopeKind": ""}, {"name": "handleFileChange", "description": "Handles the file input change event; validates image, creates object URL for preview, reads DataURL for storage, manages previous object URLs to prevent leaks."}, {"name": "handleSubmit", "description": "Handles form submission; validates input, saves acknowledgment data locally, updates document status, and navigates to 'Documents' page."}, {"name": "handleExportPdf", "description": "Generates a PDF of the page content using html2canvas and jsPDF libraries; falls back to window.print() if libraries are unavailable; uploads PDF to Admin Inbox; manages export states and errors."}], "calls": ["setDocumentCompleted(\"codeOfConduct\")", "push({ type: 'error', message })", "push({ type: 'success', message })", "import('https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js')", "import('https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js')", "window.print()", "upsertInboxPdfForUser({ codeOfConductPdf: dataUrl })"], "search-terms": ["CodeOfConduct.jsx", "React page", "localStorage acknowledgment", "PDF export", "Signature upload", "html2canvas", "jsPDF", "generate PDF", "export to PDF", "local-only data storage"], "state": 2, "file_id": 66, "knowledge_revision": 269, "git_revision": "fc96e5f98ad94fdcea96258357d4f29d8004640e", "ctags": [{"_type": "tag", "name": "CodeOfConduct", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^const CodeOfConduct = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "STORAGE_KEY", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^const STORAGE_KEY = \"code_of_conduct_ack_v1\";$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "canvas", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const canvas = await html2canvas(node, {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "contentHeight", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const contentHeight = contentWidth \\/ ratio;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "contentWidth", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const contentWidth = pageWidth - 48; \\/\\/ margins$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "dataUrl", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^        const dataUrl = reader.result || \"\";$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "dataUrl", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      let dataUrl = \"\";$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "ensurePdfLibs", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^async function ensurePdfLibs() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "exportRef", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const exportRef = useRef(null);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "file", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^    const file = e.target.files?.[0];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "handleExportPdf", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^                onClick={handleExportPdf}$/", "language": "JavaScript", "kind": "field", "scope": "onClick", "scopeKind": "class"}, {"_type": "tag", "name": "handleExportPdf", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const handleExportPdf = async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "handleFileChange", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^                  onChange={handleFileChange}$/", "language": "JavaScript", "kind": "field", "scope": "onChange", "scopeKind": "class"}, {"_type": "tag", "name": "handleFileChange", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const handleFileChange = async (e) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "handleSubmit", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^        <form onSubmit={handleSubmit} noValidate>$/", "language": "JavaScript", "kind": "field", "scope": "AnonymousClass320b71880701", "scopeKind": "class"}, {"_type": "tag", "name": "handleSubmit", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const handleSubmit = async (e) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "imgData", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const imgData = canvas.toDataURL(\"image\\/png\");$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "isImage", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^    const isImage = file.type && file.type.startsWith(\"image\\/\");$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "isValid", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^                title={isValid ? \"Export as PDF\" : \"Enter name and upload signature to enable ex/", "language": "JavaScript", "kind": "field", "scope": "title", "scopeKind": "class"}, {"_type": "tag", "name": "isValid", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const isValid = useMemo(() => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "loadLocal", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^function loadLocal() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const msg = \"Enter your name and upload a signature before exporting.\";$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^                value={name}$/", "language": "JavaScript", "kind": "field", "scope": "value", "scopeKind": "class"}, {"_type": "tag", "name": "navigate", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const navigate = useNavigate();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "node", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const node = exportRef.current;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "objectUrlRef", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const objectUrlRef = useRef(null);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "ok", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^          const ok = upsertInboxPdfForUser({ codeOfConductPdf: dataUrl });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageCanvas", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^        const pageCanvas = document.createElement(\"canvas\");$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageCanvasHeight", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^        const pageCanvasHeight = (pageHeight - 48) * (canvas.height \\/ contentHeight);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageCtx", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^        const pageCtx = pageCanvas.getContext(\"2d\");$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageHeight", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const pageHeight = pdf.internal.pageSize.getHeight();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageImg", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^          const pageImg = pageCanvas.toDataURL(\"image\\/png\");$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageWidth", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const pageWidth = pdf.internal.pageSize.getWidth();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pdf", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const pdf = new jsPDF({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "ratio", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const ratio = canvas.width \\/ canvas.height;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "reader", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const reader = new FileReader();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "remainingHeight", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^        let remainingHeight = contentHeight;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "sY", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^        let sY = 0;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "safeName", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const safeName = String(name || \"employee\").trim().replace(\\/\\\\s+\\/g, \"_\");$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "saveLocal", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^function saveLocal(state) {$/", "language": "JavaScript", "kind": "function", "signature": "(state)"}, {"_type": "tag", "name": "setError", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const [error, setError] = useState(\"\");$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setExportError", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const [exportError, setExportError] = useState(\"\");$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setExporting", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const [exporting, setExporting] = useState(false);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setFileDataUrl", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const [fileDataUrl, setFileDataUrl] = useState(\"\");$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setFileName", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const [fileName, setFileName] = useState(\"\");$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setName", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const [name, setName] = useState(\"\");$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setSaved", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const [saved, setSaved] = useState(false);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setSubmitting", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^  const [submitting, setSubmitting] = useState(false);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const url = URL.createObjectURL(file);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "we", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^            At DigitalT3, we believe that a strong code of conduct is essential to fostering a$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "x", "path": "/home/kavia/workspace/code-generation/edutrack-learning-platform-282005-282014/frontend_lms/src/pages/CodeOfConduct.jsx", "pattern": "/^      const x = 24;$/", "language": "JavaScript", "kind": "constant"}], "hash": "2f652e3f7b0ffaacbe303212187e055a", "format-version": 4, "code-base-name": "frontend_lms", "filename": "frontend_lms/src/pages/CodeOfConduct.jsx", "fields": [{"name": "let dataUrl = \"\";", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "onClick={handleExportPdf}", "scope": "onClick", "scopeKind": "class", "description": "unavailable"}, {"name": "onChange={handleFileChange}", "scope": "onChange", "scopeKind": "class", "description": "unavailable"}, {"name": "<form onSubmit={handleSubmit} noValidate>", "scope": "AnonymousClass320b71880701", "scopeKind": "class", "description": "unavailable"}, {"name": "title={isValid ? \"Export as PDF\" : \"Enter name and upload signature to enable ex/", "scope": "title", "scopeKind": "class", "description": "unavailable"}, {"name": "value={name}", "scope": "value", "scopeKind": "class", "description": "unavailable"}, {"name": "let remainingHeight = contentHeight;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let sY = 0;", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"269": "fc96e5f98ad94fdcea96258357d4f29d8004640e"}]}